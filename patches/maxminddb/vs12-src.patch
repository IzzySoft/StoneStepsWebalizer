# HG changeset patch
# Parent 0a7fe7dfadeccbfad338ad1221d8aaf9e64783b6
Source patch

diff -r 0a7fe7dfadec include/maxminddb.h
--- a/include/maxminddb.h	Sun Nov 09 23:04:52 2014 -0500
+++ b/include/maxminddb.h	Sun Nov 09 23:07:48 2014 -0500
@@ -15,7 +15,18 @@
 #ifdef _WIN32
 #include <WinSock2.h>
 #include <WS2tcpip.h>
+/* libmaxminddb package version from configure */
+#define PACKAGE_VERSION "1.0.2"
+
 typedef ADDRESS_FAMILY sa_family_t;
+
+#if defined(_MSC_VER)
+/* MSVC doesn't define signed size_t, copy it from configure */
+#define ssize_t int
+
+/* MSVC doesn't support restricted pointers */
+#define restrict
+#endif
 #else
 #include <netdb.h>
 #include <netinet/in.h>
diff -r 0a7fe7dfadec src/maxminddb.c
--- a/src/maxminddb.c	Sun Nov 09 23:04:52 2014 -0500
+++ b/src/maxminddb.c	Sun Nov 09 23:07:48 2014 -0500
@@ -238,7 +238,7 @@ int MMDB_open(const char *const filename
     mmdb->file_size = size;
 
 #ifdef _WIN32
-    HANDLE mmh = CreateFileMappingA(fd, NULL, PAGE_READONLY, 0, size, filename);
+    HANDLE mmh = CreateFileMappingA(fd, NULL, PAGE_READONLY, 0, size, NULL);
     uint8_t *file_content =
         (uint8_t *)MapViewOfFile(mmh, FILE_MAP_READ, 0, 0, 0);
     CloseHandle(fd);
